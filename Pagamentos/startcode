import psycopg2
import pandas as pd

# Configuração do banco (use suas credenciais do Supabase)
conn = psycopg2.connect(
    dbname="postgres",
    user="postgres.teotdhtxyafbgpctvtns",
    password="SENHAmaldita@33",
    host="aws-0-sa-east-1.pooler.supabase.com",
    port="6543"
)

# Ler o arquivo CSV
df = pd.read_csv('pagamento2025.csv')

# Inserir os dados
cursor = conn.cursor()
for _, row in df.iterrows():
    cursor.execute("""
        INSERT INTO pagamentos (data_emissao, data_vencimento, fornecedor, centro_custo, filial, conta_contabil, categoria, nota_fiscal, solicitacao, ordem_pagamento, lancamento_fiscal, data_lancamento, status)
        VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
    """, tuple(row))

conn.commit()
cursor.close()
conn.close()
